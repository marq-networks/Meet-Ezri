"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.upsertSettingHandler = upsertSettingHandler;
exports.getSettingHandler = getSettingHandler;
exports.getAllSettingsHandler = getAllSettingsHandler;
const system_settings_service_1 = require("./system-settings.service");
async function upsertSettingHandler(request, reply) {
    const { key, value, description } = request.body;
    // @ts-ignore - user is attached by auth plugin
    const userId = request.user?.sub;
    const setting = await (0, system_settings_service_1.upsertSetting)({ key, value, description }, userId);
    return reply.code(200).send(setting);
}
async function getSettingHandler(request, reply) {
    const { key } = request.params;
    const setting = await (0, system_settings_service_1.getSetting)(key);
    if (!setting) {
        return reply.code(404).send({ message: "Setting not found" });
    }
    return reply.code(200).send(setting);
}
async function getAllSettingsHandler(request, reply) {
    const settings = await (0, system_settings_service_1.getAllSettings)();
    return reply.code(200).send(settings);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzovVXNlcnMvU2FpZiBBbGkvRG9jdW1lbnRzL0dpdEh1Yi9NZWV0RXpyaS9hcHBzL2FwaS9zcmMvbW9kdWxlcy9zeXN0ZW0tc2V0dGluZ3Mvc3lzdGVtLXNldHRpbmdzLmNvbnRyb2xsZXIudHMiLCJzb3VyY2VzIjpbIkM6L1VzZXJzL1NhaWYgQWxpL0RvY3VtZW50cy9HaXRIdWIvTWVldEV6cmkvYXBwcy9hcGkvc3JjL21vZHVsZXMvc3lzdGVtLXNldHRpbmdzL3N5c3RlbS1zZXR0aW5ncy5jb250cm9sbGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBSUEsb0RBVUM7QUFFRCw4Q0FZQztBQUVELHNEQU1DO0FBbkNELHVFQUFzRjtBQUcvRSxLQUFLLFVBQVUsb0JBQW9CLENBQ3hDLE9BQXFELEVBQ3JELEtBQW1CO0lBRW5CLE1BQU0sRUFBRSxHQUFHLEVBQUUsS0FBSyxFQUFFLFdBQVcsRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7SUFDakQsK0NBQStDO0lBQy9DLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDO0lBRWpDLE1BQU0sT0FBTyxHQUFHLE1BQU0sSUFBQSx1Q0FBYSxFQUFDLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUN6RSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3ZDLENBQUM7QUFFTSxLQUFLLFVBQVUsaUJBQWlCLENBQ3JDLE9BQW9ELEVBQ3BELEtBQW1CO0lBRW5CLE1BQU0sRUFBRSxHQUFHLEVBQUUsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO0lBQy9CLE1BQU0sT0FBTyxHQUFHLE1BQU0sSUFBQSxvQ0FBVSxFQUFDLEdBQUcsQ0FBQyxDQUFDO0lBRXRDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNiLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7SUFFRCxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQ3ZDLENBQUM7QUFFTSxLQUFLLFVBQVUscUJBQXFCLENBQ3pDLE9BQXVCLEVBQ3ZCLEtBQW1CO0lBRW5CLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBQSx3Q0FBYyxHQUFFLENBQUM7SUFDeEMsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUN4QyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRmFzdGlmeVJlcGx5LCBGYXN0aWZ5UmVxdWVzdCB9IGZyb20gXCJmYXN0aWZ5XCI7XG5pbXBvcnQgeyB1cHNlcnRTZXR0aW5nLCBnZXRTZXR0aW5nLCBnZXRBbGxTZXR0aW5ncyB9IGZyb20gXCIuL3N5c3RlbS1zZXR0aW5ncy5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBVcHNlcnRTZXR0aW5nSW5wdXQsIEdldFNldHRpbmdJbnB1dCB9IGZyb20gXCIuL3N5c3RlbS1zZXR0aW5ncy5zY2hlbWFcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwc2VydFNldHRpbmdIYW5kbGVyKFxuICByZXF1ZXN0OiBGYXN0aWZ5UmVxdWVzdDx7IEJvZHk6IFVwc2VydFNldHRpbmdJbnB1dCB9PixcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxuKSB7XG4gIGNvbnN0IHsga2V5LCB2YWx1ZSwgZGVzY3JpcHRpb24gfSA9IHJlcXVlc3QuYm9keTtcbiAgLy8gQHRzLWlnbm9yZSAtIHVzZXIgaXMgYXR0YWNoZWQgYnkgYXV0aCBwbHVnaW5cbiAgY29uc3QgdXNlcklkID0gcmVxdWVzdC51c2VyPy5zdWI7XG5cbiAgY29uc3Qgc2V0dGluZyA9IGF3YWl0IHVwc2VydFNldHRpbmcoeyBrZXksIHZhbHVlLCBkZXNjcmlwdGlvbiB9LCB1c2VySWQpO1xuICByZXR1cm4gcmVwbHkuY29kZSgyMDApLnNlbmQoc2V0dGluZyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXR0aW5nSGFuZGxlcihcbiAgcmVxdWVzdDogRmFzdGlmeVJlcXVlc3Q8eyBQYXJhbXM6IEdldFNldHRpbmdJbnB1dCB9PixcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxuKSB7XG4gIGNvbnN0IHsga2V5IH0gPSByZXF1ZXN0LnBhcmFtcztcbiAgY29uc3Qgc2V0dGluZyA9IGF3YWl0IGdldFNldHRpbmcoa2V5KTtcbiAgXG4gIGlmICghc2V0dGluZykge1xuICAgIHJldHVybiByZXBseS5jb2RlKDQwNCkuc2VuZCh7IG1lc3NhZ2U6IFwiU2V0dGluZyBub3QgZm91bmRcIiB9KTtcbiAgfVxuICBcbiAgcmV0dXJuIHJlcGx5LmNvZGUoMjAwKS5zZW5kKHNldHRpbmcpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsU2V0dGluZ3NIYW5kbGVyKFxuICByZXF1ZXN0OiBGYXN0aWZ5UmVxdWVzdCxcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxuKSB7XG4gIGNvbnN0IHNldHRpbmdzID0gYXdhaXQgZ2V0QWxsU2V0dGluZ3MoKTtcbiAgcmV0dXJuIHJlcGx5LmNvZGUoMjAwKS5zZW5kKHNldHRpbmdzKTtcbn1cbiJdfQ==