"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getContactsHandler = getContactsHandler;
exports.createContactHandler = createContactHandler;
exports.updateContactHandler = updateContactHandler;
exports.deleteContactHandler = deleteContactHandler;
const emergency_contacts_service_1 = require("./emergency-contacts.service");
async function getContactsHandler(request, reply) {
    const user = request.user;
    const contacts = await (0, emergency_contacts_service_1.getEmergencyContacts)(user.id);
    return reply.code(200).send(contacts);
}
async function createContactHandler(request, reply) {
    const user = request.user;
    const contact = await (0, emergency_contacts_service_1.createEmergencyContact)(user.id, request.body);
    return reply.code(201).send(contact);
}
async function updateContactHandler(request, reply) {
    const user = request.user;
    const { id } = request.params;
    try {
        const contact = await (0, emergency_contacts_service_1.updateEmergencyContact)(user.id, id, request.body);
        return reply.code(200).send(contact);
    }
    catch (error) {
        return reply.code(404).send({ message: 'Contact not found' });
    }
}
async function deleteContactHandler(request, reply) {
    const user = request.user;
    const { id } = request.params;
    try {
        await (0, emergency_contacts_service_1.deleteEmergencyContact)(user.id, id);
        return reply.code(204).send();
    }
    catch (error) {
        return reply.code(404).send({ message: 'Contact not found' });
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzovVXNlcnMvU2FpZiBBbGkvRG9jdW1lbnRzL0dpdEh1Yi9NZWV0RXpyaS9hcHBzL2FwaS9zcmMvbW9kdWxlcy91c2Vycy9lbWVyZ2VuY3ktY29udGFjdHMuY29udHJvbGxlci50cyIsInNvdXJjZXMiOlsiQzovVXNlcnMvU2FpZiBBbGkvRG9jdW1lbnRzL0dpdEh1Yi9NZWV0RXpyaS9hcHBzL2FwaS9zcmMvbW9kdWxlcy91c2Vycy9lbWVyZ2VuY3ktY29udGFjdHMuY29udHJvbGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUlBLGdEQU9DO0FBRUQsb0RBT0M7QUFFRCxvREFZQztBQUVELG9EQVlDO0FBOUNELDZFQUE0STtBQUVySSxLQUFLLFVBQVUsa0JBQWtCLENBQ3RDLE9BQXVCLEVBQ3ZCLEtBQW1CO0lBRW5CLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFzQixDQUFDO0lBQzVDLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBQSxpREFBb0IsRUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDckQsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUN4QyxDQUFDO0FBRU0sS0FBSyxVQUFVLG9CQUFvQixDQUN4QyxPQUE4RCxFQUM5RCxLQUFtQjtJQUVuQixNQUFNLElBQUksR0FBRyxPQUFPLENBQUMsSUFBc0IsQ0FBQztJQUM1QyxNQUFNLE9BQU8sR0FBRyxNQUFNLElBQUEsbURBQXNCLEVBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEUsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN2QyxDQUFDO0FBRU0sS0FBSyxVQUFVLG9CQUFvQixDQUN4QyxPQUFzRixFQUN0RixLQUFtQjtJQUVuQixNQUFNLElBQUksR0FBRyxPQUFPLENBQUMsSUFBc0IsQ0FBQztJQUM1QyxNQUFNLEVBQUUsRUFBRSxFQUFFLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztJQUM5QixJQUFJLENBQUM7UUFDSCxNQUFNLE9BQU8sR0FBRyxNQUFNLElBQUEsbURBQXNCLEVBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hFLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDdkMsQ0FBQztJQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7UUFDZixPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLENBQUMsQ0FBQztJQUNoRSxDQUFDO0FBQ0gsQ0FBQztBQUVNLEtBQUssVUFBVSxvQkFBb0IsQ0FDeEMsT0FBbUQsRUFDbkQsS0FBbUI7SUFFbkIsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQXNCLENBQUM7SUFDNUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7SUFDOUIsSUFBSSxDQUFDO1FBQ0gsTUFBTSxJQUFBLG1EQUFzQixFQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDMUMsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2hDLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxDQUFDLENBQUM7SUFDaEUsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGYXN0aWZ5UmVwbHksIEZhc3RpZnlSZXF1ZXN0IH0gZnJvbSAnZmFzdGlmeSc7XG5pbXBvcnQgeyBDcmVhdGVFbWVyZ2VuY3lDb250YWN0SW5wdXQsIFVwZGF0ZUVtZXJnZW5jeUNvbnRhY3RJbnB1dCB9IGZyb20gJy4vZW1lcmdlbmN5LWNvbnRhY3RzLnNjaGVtYSc7XG5pbXBvcnQgeyBnZXRFbWVyZ2VuY3lDb250YWN0cywgY3JlYXRlRW1lcmdlbmN5Q29udGFjdCwgdXBkYXRlRW1lcmdlbmN5Q29udGFjdCwgZGVsZXRlRW1lcmdlbmN5Q29udGFjdCB9IGZyb20gJy4vZW1lcmdlbmN5LWNvbnRhY3RzLnNlcnZpY2UnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29udGFjdHNIYW5kbGVyKFxuICByZXF1ZXN0OiBGYXN0aWZ5UmVxdWVzdCxcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxuKSB7XG4gIGNvbnN0IHVzZXIgPSByZXF1ZXN0LnVzZXIgYXMgeyBpZDogc3RyaW5nIH07XG4gIGNvbnN0IGNvbnRhY3RzID0gYXdhaXQgZ2V0RW1lcmdlbmN5Q29udGFjdHModXNlci5pZCk7XG4gIHJldHVybiByZXBseS5jb2RlKDIwMCkuc2VuZChjb250YWN0cyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVDb250YWN0SGFuZGxlcihcbiAgcmVxdWVzdDogRmFzdGlmeVJlcXVlc3Q8eyBCb2R5OiBDcmVhdGVFbWVyZ2VuY3lDb250YWN0SW5wdXQgfT4sXG4gIHJlcGx5OiBGYXN0aWZ5UmVwbHlcbikge1xuICBjb25zdCB1c2VyID0gcmVxdWVzdC51c2VyIGFzIHsgaWQ6IHN0cmluZyB9O1xuICBjb25zdCBjb250YWN0ID0gYXdhaXQgY3JlYXRlRW1lcmdlbmN5Q29udGFjdCh1c2VyLmlkLCByZXF1ZXN0LmJvZHkpO1xuICByZXR1cm4gcmVwbHkuY29kZSgyMDEpLnNlbmQoY29udGFjdCk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDb250YWN0SGFuZGxlcihcbiAgcmVxdWVzdDogRmFzdGlmeVJlcXVlc3Q8eyBQYXJhbXM6IHsgaWQ6IHN0cmluZyB9OyBCb2R5OiBVcGRhdGVFbWVyZ2VuY3lDb250YWN0SW5wdXQgfT4sXG4gIHJlcGx5OiBGYXN0aWZ5UmVwbHlcbikge1xuICBjb25zdCB1c2VyID0gcmVxdWVzdC51c2VyIGFzIHsgaWQ6IHN0cmluZyB9O1xuICBjb25zdCB7IGlkIH0gPSByZXF1ZXN0LnBhcmFtcztcbiAgdHJ5IHtcbiAgICBjb25zdCBjb250YWN0ID0gYXdhaXQgdXBkYXRlRW1lcmdlbmN5Q29udGFjdCh1c2VyLmlkLCBpZCwgcmVxdWVzdC5ib2R5KTtcbiAgICByZXR1cm4gcmVwbHkuY29kZSgyMDApLnNlbmQoY29udGFjdCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHJlcGx5LmNvZGUoNDA0KS5zZW5kKHsgbWVzc2FnZTogJ0NvbnRhY3Qgbm90IGZvdW5kJyB9KTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQ29udGFjdEhhbmRsZXIoXG4gIHJlcXVlc3Q6IEZhc3RpZnlSZXF1ZXN0PHsgUGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9PixcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxuKSB7XG4gIGNvbnN0IHVzZXIgPSByZXF1ZXN0LnVzZXIgYXMgeyBpZDogc3RyaW5nIH07XG4gIGNvbnN0IHsgaWQgfSA9IHJlcXVlc3QucGFyYW1zO1xuICB0cnkge1xuICAgIGF3YWl0IGRlbGV0ZUVtZXJnZW5jeUNvbnRhY3QodXNlci5pZCwgaWQpO1xuICAgIHJldHVybiByZXBseS5jb2RlKDIwNCkuc2VuZCgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiByZXBseS5jb2RlKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdDb250YWN0IG5vdCBmb3VuZCcgfSk7XG4gIH1cbn1cbiJdfQ==