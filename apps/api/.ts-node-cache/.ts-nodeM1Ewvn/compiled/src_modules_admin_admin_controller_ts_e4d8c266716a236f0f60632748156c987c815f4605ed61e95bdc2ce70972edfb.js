"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDashboardStatsHandler = getDashboardStatsHandler;
exports.getUsersHandler = getUsersHandler;
exports.getUserHandler = getUserHandler;
exports.updateUserHandler = updateUserHandler;
exports.deleteUserHandler = deleteUserHandler;
exports.getUserAuditLogsHandler = getUserAuditLogsHandler;
const admin_service_1 = require("./admin.service");
async function getDashboardStatsHandler(request, reply) {
    try {
        const stats = await (0, admin_service_1.getDashboardStats)();
        return reply.code(200).send(stats);
    }
    catch (error) {
        request.log.error(error);
        return reply.code(500).send({ message: 'Failed to fetch dashboard stats' });
    }
}
async function getUsersHandler(request, reply) {
    try {
        const users = await (0, admin_service_1.getAllUsers)();
        return reply.code(200).send(users);
    }
    catch (error) {
        request.log.error(error);
        return reply.code(500).send({ message: 'Failed to fetch users' });
    }
}
async function getUserHandler(request, reply) {
    try {
        const { id } = request.params;
        const user = await (0, admin_service_1.getUserById)(id);
        if (!user) {
            return reply.code(404).send({ message: 'User not found' });
        }
        return reply.code(200).send(user);
    }
    catch (error) {
        request.log.error(error);
        return reply.code(500).send({ message: 'Failed to fetch user' });
    }
}
async function updateUserHandler(request, reply) {
    try {
        const { id } = request.params;
        const data = request.body;
        const user = await (0, admin_service_1.updateUser)(id, data);
        return reply.code(200).send(user);
    }
    catch (error) {
        request.log.error(error);
        return reply.code(500).send({ message: 'Failed to update user' });
    }
}
async function deleteUserHandler(request, reply) {
    try {
        const { id } = request.params;
        await (0, admin_service_1.deleteUser)(id);
        return reply.code(200).send({ message: 'User deleted successfully' });
    }
    catch (error) {
        request.log.error(error);
        return reply.code(500).send({ message: 'Failed to delete user' });
    }
}
async function getUserAuditLogsHandler(request, reply) {
    try {
        const { id } = request.params;
        const logs = await (0, admin_service_1.getUserAuditLogs)(id);
        return reply.code(200).send(logs);
    }
    catch (error) {
        request.log.error(error);
        return reply.code(500).send({ message: 'Failed to fetch user audit logs' });
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzovVXNlcnMvU2FpZiBBbGkvRG9jdW1lbnRzL0dpdEh1Yi9NZWV0RXpyaS9hcHBzL2FwaS9zcmMvbW9kdWxlcy9hZG1pbi9hZG1pbi5jb250cm9sbGVyLnRzIiwic291cmNlcyI6WyJDOi9Vc2Vycy9TYWlmIEFsaS9Eb2N1bWVudHMvR2l0SHViL01lZXRFenJpL2FwcHMvYXBpL3NyYy9tb2R1bGVzL2FkbWluL2FkbWluLmNvbnRyb2xsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFLQSw0REFXQztBQUVELDBDQVdDO0FBRUQsd0NBZUM7QUFFRCw4Q0FhQztBQUVELDhDQVlDO0FBRUQsMERBWUM7QUF4RkQsbURBQXdIO0FBSWpILEtBQUssVUFBVSx3QkFBd0IsQ0FDNUMsT0FBdUIsRUFDdkIsS0FBbUI7SUFFbkIsSUFBSSxDQUFDO1FBQ0gsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFBLGlDQUFpQixHQUFFLENBQUM7UUFDeEMsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBQUMsT0FBTyxLQUFLLEVBQUUsQ0FBQztRQUNmLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3pCLE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxPQUFPLEVBQUUsaUNBQWlDLEVBQUUsQ0FBQyxDQUFDO0lBQzlFLENBQUM7QUFDSCxDQUFDO0FBRU0sS0FBSyxVQUFVLGVBQWUsQ0FDbkMsT0FBdUIsRUFDdkIsS0FBbUI7SUFFbkIsSUFBSSxDQUFDO1FBQ0gsTUFBTSxLQUFLLEdBQUcsTUFBTSxJQUFBLDJCQUFXLEdBQUUsQ0FBQztRQUNsQyxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFBQyxPQUFP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O1FBQzlCLE1BQU0sSUFBSSxHQUFHLE1BQU0sSUFBQSxnQ0FBZ0IsRUFBQyxFQUFFLENBQUMsQ0FBQztRQUN4QyxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDekIsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSxpQ0FBaUMsRUFBRSxDQUFDLENBQUM7SUFDOUUsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGYXN0aWZ5UmVwbHksIEZhc3RpZnlSZXF1ZXN0IH0gZnJvbSAnZmFzdGlmeSc7XHJcbmltcG9ydCB7IGdldERhc2hib2FyZFN0YXRzLCBnZXRBbGxVc2VycywgZ2V0VXNlckJ5SWQsIHVwZGF0ZVVzZXIsIGRlbGV0ZVVzZXIsIGdldFVzZXJBdWRpdExvZ3MgfSBmcm9tICcuL2FkbWluLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyB1cGRhdGVVc2VyU2NoZW1hIH0gZnJvbSAnLi9hZG1pbi5zY2hlbWEnO1xyXG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXREYXNoYm9hcmRTdGF0c0hhbmRsZXIoXHJcbiAgcmVxdWVzdDogRmFzdGlmeVJlcXVlc3QsXHJcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3Qgc3RhdHMgPSBhd2FpdCBnZXREYXNoYm9hcmRTdGF0cygpO1xyXG4gICAgcmV0dXJuIHJlcGx5LmNvZGUoMjAwKS5zZW5kKHN0YXRzKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgcmVxdWVzdC5sb2cuZXJyb3IoZXJyb3IpO1xyXG4gICAgcmV0dXJuIHJlcGx5LmNvZGUoNTAwKS5zZW5kKHsgbWVzc2FnZTogJ0ZhaWxlZCB0byBmZXRjaCBkYXNoYm9hcmQgc3RhdHMnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJzSGFuZGxlcihcclxuICByZXF1ZXN0OiBGYXN0aWZ5UmVxdWVzdCxcclxuICByZXBseTogRmFzdGlmeVJlcGx5XHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB1c2VycyA9IGF3YWl0IGdldEFsbFVzZXJzKCk7XHJcbiAgICByZXR1cm4gcmVwbHkuY29kZSgyMDApLnNlbmQodXNlcnMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXF1ZXN0LmxvZy5lcnJvcihlcnJvcik7XHJcbiAgICByZXR1cm4gcmVwbHkuY29kZSg1MDApLnNlbmQoeyBtZXNzYWdlOiAnRmFpbGVkIHRvIGZldGNoIHVzZXJzJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VySGFuZGxlcihcclxuICByZXF1ZXN0OiBGYXN0aWZ5UmVxdWVzdDx7IFBhcmFtczogeyBpZDogc3RyaW5nIH0gfT4sXHJcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcmVxdWVzdC5wYXJhbXM7XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZ2V0VXNlckJ5SWQoaWQpO1xyXG4gICAgaWYgKCF1c2VyKSB7XHJcbiAgICAgIHJldHVybiByZXBseS5jb2RlKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdVc2VyIG5vdCBmb3VuZCcgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVwbHkuY29kZSgyMDApLnNlbmQodXNlcik7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcXVlc3QubG9nLmVycm9yKGVycm9yKTtcclxuICAgIHJldHVybiByZXBseS5jb2RlKDUwMCkuc2VuZCh7IG1lc3NhZ2U6ICdGYWlsZWQgdG8gZmV0Y2ggdXNlcicgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXNlckhhbmRsZXIoXHJcbiAgcmVxdWVzdDogRmFzdGlmeVJlcXVlc3Q8eyBQYXJhbXM6IHsgaWQ6IHN0cmluZyB9LCBCb2R5OiB6LmluZmVyPHR5cGVvZiB1cGRhdGVVc2VyU2NoZW1hPiB9PixcclxuICByZXBseTogRmFzdGlmeVJlcGx5XHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGlkIH0gPSByZXF1ZXN0LnBhcmFtcztcclxuICAgIGNvbnN0IGRhdGEgPSByZXF1ZXN0LmJvZHk7XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgdXBkYXRlVXNlcihpZCwgZGF0YSk7XHJcbiAgICByZXR1cm4gcmVwbHkuY29kZSgyMDApLnNlbmQodXNlcik7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcXVlc3QubG9nLmVycm9yKGVycm9yKTtcclxuICAgIHJldHVybiByZXBseS5jb2RlKDUwMCkuc2VuZCh7IG1lc3NhZ2U6ICdGYWlsZWQgdG8gdXBkYXRlIHVzZXInIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVVzZXJIYW5kbGVyKFxyXG4gIHJlcXVlc3Q6IEZhc3RpZnlSZXF1ZXN0PHsgUGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9PixcclxuICByZXBseTogRmFzdGlmeVJlcGx5XHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGlkIH0gPSByZXF1ZXN0LnBhcmFtcztcclxuICAgIGF3YWl0IGRlbGV0ZVVzZXIoaWQpO1xyXG4gICAgcmV0dXJuIHJlcGx5LmNvZGUoMjAwKS5zZW5kKHsgbWVzc2FnZTogJ1VzZXIgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXF1ZXN0LmxvZy5lcnJvcihlcnJvcik7XHJcbiAgICByZXR1cm4gcmVwbHkuY29kZSg1MDApLnNlbmQoeyBtZXNzYWdlOiAnRmFpbGVkIHRvIGRlbGV0ZSB1c2VyJyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyQXVkaXRMb2dzSGFuZGxlcihcclxuICByZXF1ZXN0OiBGYXN0aWZ5UmVxdWVzdDx7IFBhcmFtczogeyBpZDogc3RyaW5nIH0gfT4sXHJcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxyXG4pIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgeyBpZCB9ID0gcmVxdWVzdC5wYXJhbXM7XHJcbiAgICBjb25zdCBsb2dzID0gYXdhaXQgZ2V0VXNlckF1ZGl0TG9ncyhpZCk7XHJcbiAgICByZXR1cm4gcmVwbHkuY29kZSgyMDApLnNlbmQobG9ncyk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJlcXVlc3QubG9nLmVycm9yKGVycm9yKTtcclxuICAgIHJldHVybiByZXBseS5jb2RlKDUwMCkuc2VuZCh7IG1lc3NhZ2U6ICdGYWlsZWQgdG8gZmV0Y2ggdXNlciBhdWRpdCBsb2dzJyB9KTtcclxuICB9XHJcbn1cclxuIl19