"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createJournalHandler = createJournalHandler;
exports.getJournalsHandler = getJournalsHandler;
exports.getJournalByIdHandler = getJournalByIdHandler;
exports.updateJournalHandler = updateJournalHandler;
exports.getUserJournalsHandler = getUserJournalsHandler;
exports.deleteJournalHandler = deleteJournalHandler;
const journal_service_1 = require("./journal.service");
async function createJournalHandler(request, reply) {
    const user = request.user;
    const journal = await (0, journal_service_1.createJournalEntry)(user.id, request.body);
    return reply.code(201).send(journal);
}
async function getJournalsHandler(request, reply) {
    const user = request.user;
    const journals = await (0, journal_service_1.getJournalEntries)(user.id);
    return reply.send(journals);
}
async function getJournalByIdHandler(request, reply) {
    const user = request.user;
    const { id } = request.params;
    const journal = await (0, journal_service_1.getJournalEntryById)(user.id, id);
    if (!journal) {
        return reply.code(404).send({ message: 'Journal entry not found' });
    }
    return reply.send(journal);
}
async function updateJournalHandler(request, reply) {
    const user = request.user;
    const { id } = request.params;
    try {
        const journal = await (0, journal_service_1.updateJournalEntry)(user.id, id, request.body);
        return reply.send(journal);
    }
    catch (error) {
        return reply.code(404).send({ message: 'Journal entry not found' });
    }
}
async function getUserJournalsHandler(request, reply) {
    const { userId } = request.params;
    const journals = await (0, journal_service_1.getJournalEntries)(userId);
    return reply.send(journals);
}
async function deleteJournalHandler(request, reply) {
    const user = request.user;
    const { id } = request.params;
    try {
        await (0, journal_service_1.deleteJournalEntry)(user.id, id);
        return reply.code(204).send();
    }
    catch (error) {
        return reply.code(404).send({ message: 'Journal entry not found' });
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQzovVXNlcnMvU2FpZiBBbGkvRG9jdW1lbnRzL0dpdEh1Yi9NZWV0RXpyaS9hcHBzL2FwaS9zcmMvbW9kdWxlcy9qb3VybmFsL2pvdXJuYWwuY29udHJvbGxlci50cyIsInNvdXJjZXMiOlsiQzovVXNlcnMvU2FpZiBBbGkvRG9jdW1lbnRzL0dpdEh1Yi9NZWV0RXpyaS9hcHBzL2FwaS9zcmMvbW9kdWxlcy9qb3VybmFsL2pvdXJuYWwuY29udHJvbGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUlBLG9EQU9DO0FBRUQsZ0RBT0M7QUFFRCxzREFhQztBQUVELG9EQWFDO0FBRUQsd0RBT0M7QUFFRCxvREFhQztBQXpFRCx1REFBdUk7QUFHaEksS0FBSyxVQUFVLG9CQUFvQixDQUN4QyxPQUFxRCxFQUNyRCxLQUFtQjtJQUVuQixNQUFNLElBQUksR0FBRyxPQUFPLENBQUMsSUFBc0IsQ0FBQztJQUM1QyxNQUFNLE9BQU8sR0FBRyxNQUFNLElBQUEsb0NBQWtCLEVBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDaEUsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN2QyxDQUFDO0FBRU0sS0FBSyxVQUFVLGtCQUFrQixDQUN0QyxPQUF1QixFQUN2QixLQUFtQjtJQUVuQixNQUFNLElBQUksR0FBRyxPQUFPLENBQUMsSUFBc0IsQ0FBQztJQUM1QyxNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUEsbUNBQWlCLEVBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ2xELE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUM5QixDQUFDO0FBRU0sS0FBSyxVQUFVLHFCQUFxQixDQUN6QyxPQUFtRCxFQUNuRCxLQUFtQjtJQUVuQixNQUFNLElBQUksR0FBRyxPQUFPLENBQUMsSUFBc0IsQ0FBQztJQUM1QyxNQUFNLEVBQUUsRUFBRSxFQUFFLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztJQUM5QixNQUFNLE9BQU8sR0FBRyxNQUFNLElBQUEscUNBQW1CLEVBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUV2RCxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDYixPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsT0FBTyxFQUFFLHlCQUF5QixFQUFFLENBQUMsQ0FBQztJQUN0RSxDQUFDO0lBRUQsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQzdCLENBQUM7QUFFTSxLQUFLLFVBQVUsb0JBQW9CLENBQ3hDLE9BQTZFLEVBQzdFLEtBQW1CO0lBRW5CLE1BQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFzQixDQUFDO0lBQzVDLE1BQU0sRUFBRSxFQUFFLEVBQUUsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO0lBRTlCLElBQUksQ0FBQztRQUNILE1BQU0sT0FBTyxHQUFHLE1BQU0sSUFBQSxvQ0FBa0IsRUFBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEUsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxDQUFDLENBQUM7SUFDdEUsQ0FBQztBQUNILENBQUM7QUFFTSxLQUFLLFVBQVUsc0JBQXNCLENBQzFDLE9BQXVELEVBQ3ZELEtBQW1CO0lBRW5CLE1BQU0sRUFBRSxNQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO0lBQ2xDLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBQSxtQ0FBaUIsRUFBQyxNQUFNLENBQUMsQ0FBQztJQUNqRCxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDOUIsQ0FBQztBQUVNLEtBQUssVUFBVSxvQkFBb0IsQ0FDeEMsT0FBbUQsRUFDbkQsS0FBbUI7SUFFbkIsTUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQXNCLENBQUM7SUFDNUMsTUFBTSxFQUFFLEVBQUUsRUFBRSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7SUFFOUIsSUFBSSxDQUFDO1FBQ0gsTUFBTSxJQUFBLG9DQUFrQixFQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDdEMsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ2hDLENBQUM7SUFBQyxPQUFPLEtBQUssRUFBRSxDQUFDO1FBQ2YsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxDQUFDLENBQUM7SUFDdEUsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGYXN0aWZ5UmVwbHksIEZhc3RpZnlSZXF1ZXN0IH0gZnJvbSAnZmFzdGlmeSc7XG5pbXBvcnQgeyBjcmVhdGVKb3VybmFsRW50cnksIGRlbGV0ZUpvdXJuYWxFbnRyeSwgZ2V0Sm91cm5hbEVudHJpZXMsIGdldEpvdXJuYWxFbnRyeUJ5SWQsIHVwZGF0ZUpvdXJuYWxFbnRyeSB9IGZyb20gJy4vam91cm5hbC5zZXJ2aWNlJztcbmltcG9ydCB7IENyZWF0ZUpvdXJuYWxJbnB1dCwgVXBkYXRlSm91cm5hbElucHV0IH0gZnJvbSAnLi9qb3VybmFsLnNjaGVtYSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVKb3VybmFsSGFuZGxlcihcbiAgcmVxdWVzdDogRmFzdGlmeVJlcXVlc3Q8eyBCb2R5OiBDcmVhdGVKb3VybmFsSW5wdXQgfT4sXG4gIHJlcGx5OiBGYXN0aWZ5UmVwbHlcbikge1xuICBjb25zdCB1c2VyID0gcmVxdWVzdC51c2VyIGFzIHsgaWQ6IHN0cmluZyB9O1xuICBjb25zdCBqb3VybmFsID0gYXdhaXQgY3JlYXRlSm91cm5hbEVudHJ5KHVzZXIuaWQsIHJlcXVlc3QuYm9keSk7XG4gIHJldHVybiByZXBseS5jb2RlKDIwMSkuc2VuZChqb3VybmFsKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEpvdXJuYWxzSGFuZGxlcihcbiAgcmVxdWVzdDogRmFzdGlmeVJlcXVlc3QsXG4gIHJlcGx5OiBGYXN0aWZ5UmVwbHlcbikge1xuICBjb25zdCB1c2VyID0gcmVxdWVzdC51c2VyIGFzIHsgaWQ6IHN0cmluZyB9O1xuICBjb25zdCBqb3VybmFscyA9IGF3YWl0IGdldEpvdXJuYWxFbnRyaWVzKHVzZXIuaWQpO1xuICByZXR1cm4gcmVwbHkuc2VuZChqb3VybmFscyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRKb3VybmFsQnlJZEhhbmRsZXIoXG4gIHJlcXVlc3Q6IEZhc3RpZnlSZXF1ZXN0PHsgUGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9PixcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxuKSB7XG4gIGNvbnN0IHVzZXIgPSByZXF1ZXN0LnVzZXIgYXMgeyBpZDogc3RyaW5nIH07XG4gIGNvbnN0IHsgaWQgfSA9IHJlcXVlc3QucGFyYW1zO1xuICBjb25zdCBqb3VybmFsID0gYXdhaXQgZ2V0Sm91cm5hbEVudHJ5QnlJZCh1c2VyLmlkLCBpZCk7XG4gIFxuICBpZiAoIWpvdXJuYWwpIHtcbiAgICByZXR1cm4gcmVwbHkuY29kZSg0MDQpLnNlbmQoeyBtZXNzYWdlOiAnSm91cm5hbCBlbnRyeSBub3QgZm91bmQnIH0pO1xuICB9XG4gIFxuICByZXR1cm4gcmVwbHkuc2VuZChqb3VybmFsKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUpvdXJuYWxIYW5kbGVyKFxuICByZXF1ZXN0OiBGYXN0aWZ5UmVxdWVzdDx7IFBhcmFtczogeyBpZDogc3RyaW5nIH07IEJvZHk6IFVwZGF0ZUpvdXJuYWxJbnB1dCB9PixcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxuKSB7XG4gIGNvbnN0IHVzZXIgPSByZXF1ZXN0LnVzZXIgYXMgeyBpZDogc3RyaW5nIH07XG4gIGNvbnN0IHsgaWQgfSA9IHJlcXVlc3QucGFyYW1zO1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBqb3VybmFsID0gYXdhaXQgdXBkYXRlSm91cm5hbEVudHJ5KHVzZXIuaWQsIGlkLCByZXF1ZXN0LmJvZHkpO1xuICAgIHJldHVybiByZXBseS5zZW5kKGpvdXJuYWwpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiByZXBseS5jb2RlKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdKb3VybmFsIGVudHJ5IG5vdCBmb3VuZCcgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJKb3VybmFsc0hhbmRsZXIoXG4gIHJlcXVlc3Q6IEZhc3RpZnlSZXF1ZXN0PHsgUGFyYW1zOiB7IHVzZXJJZDogc3RyaW5nIH0gfT4sXG4gIHJlcGx5OiBGYXN0aWZ5UmVwbHlcbikge1xuICBjb25zdCB7IHVzZXJJZCB9ID0gcmVxdWVzdC5wYXJhbXM7XG4gIGNvbnN0IGpvdXJuYWxzID0gYXdhaXQgZ2V0Sm91cm5hbEVudHJpZXModXNlcklkKTtcbiAgcmV0dXJuIHJlcGx5LnNlbmQoam91cm5hbHMpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlSm91cm5hbEhhbmRsZXIoXG4gIHJlcXVlc3Q6IEZhc3RpZnlSZXF1ZXN0PHsgUGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9PixcbiAgcmVwbHk6IEZhc3RpZnlSZXBseVxuKSB7XG4gIGNvbnN0IHVzZXIgPSByZXF1ZXN0LnVzZXIgYXMgeyBpZDogc3RyaW5nIH07XG4gIGNvbnN0IHsgaWQgfSA9IHJlcXVlc3QucGFyYW1zO1xuICBcbiAgdHJ5IHtcbiAgICBhd2FpdCBkZWxldGVKb3VybmFsRW50cnkodXNlci5pZCwgaWQpO1xuICAgIHJldHVybiByZXBseS5jb2RlKDIwNCkuc2VuZCgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiByZXBseS5jb2RlKDQwNCkuc2VuZCh7IG1lc3NhZ2U6ICdKb3VybmFsIGVudHJ5IG5vdCBmb3VuZCcgfSk7XG4gIH1cbn1cbiJdfQ==